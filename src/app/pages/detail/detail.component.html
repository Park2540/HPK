
  <div class="items">
    <h2 class="ptaxt">รายละเอียด</h2>
<br>
<table class="ttt">
  <tr>
    <th></th>
    <th></th>
  </tr>
  
    <tr>
      <td>
        ติดตามสถานะ :
      </td>
      <td>
        <i class="fa fa-clone " aria-hidden="true" (click)="Copy(detail.id)"> คัดลอก</i>
      </td>
    </tr>
    <tr>
      <td>รหัสอ้างอิง :</td>
      <td>{{detail.id }}</td>
    </tr>
    <tr>
      <td>หน่วยงาน :</td>
      <span *ngFor="let agencies of detail.agencies;let i = index ">
        <td>{{agencies.name}}</td>
      </span>
     
    </tr>
    <tr>
      <td>ช่องทางการแจ้ง :</td>
      <span *ngFor="let contacts of detail.contacts;let i = index ">
        <td>{{contacts.name}}</td>
      </span>
    </tr>
    <tr>
      <td>ผู้แจ้ง :</td>
      <td>{{detail.informer}}</td>
    </tr>
    <tr>
      <td>ข้อความการแจ้ง :</td>
      <td>{{detail.informermessage}}</td>
    </tr>
    <tr>
      <td>เวลาการแจ้ง :</td>
      <td>{{detail.timebyuser *1000| date: 'dd/MM/yyyy HH:mm'}}</td>
    </tr>
    <tr>
      <td>เวลารับเรื่อง :</td>
      <td>{{detail.created_at *1000| date: 'dd/MM/yyyy HH:mm'}}</td>
    </tr>
    <tr>
      <td>กำหนดการเสร็จสิ้น :</td>
      <td>{{((detail.levels[0].time + detail.created_at))*1000 | date: 'dd/MM/yyyy HH:mm' }}</td>
    </tr>
    <tr>
      <td>ระบบ :</td>
      <span *ngFor="let systems of detail.systems;let i = index ">
  
        <td>{{systems.name}}</td>
  
        <div *ngIf="i != detail.systems.length - 1 ">,</div>
      </span>
    </tr>
    
    <tr>
      <td>ความรุนแรง :</td>
      <span>
        <div *ngIf=" detail.levels[0].id == 1" class="badge badge-success">
          {{( detail.levels[0].name)}} 
         </div>
         <div *ngIf=" detail.levels[0].id == 2" class="badge badge-warning">
          {{( detail.levels[0].name)}} 
         </div>
         <div *ngIf=" detail.levels[0].id == 3" class="badge badge-danger">
          {{( detail.levels[0].name)}} 
         </div>
         <div *ngIf=" detail.levels[0].id == 4" class="badge badge-warning">
          {{( detail.levels[0].name)}}  
         </div>
         <div *ngIf=" detail.levels[0].id == 5" class="badge badge-warning">
          {{( detail.levels[0].name)}}  
         </div>
         <div *ngIf=" detail.levels[0].id == 6" class="badge badge-warning">
          {{( detail.levels[0].name)}}  
           </div>
      </span>
    </tr>
    
    <tr>
      <td>
        สถานะ :
      </td>
      <span>
        <div *ngIf="detail.status.id == 1" class="badge badge-primary">
          {{(detail.status.name)}} 
        </div>
        <div *ngIf="detail.status.id == 2" class="badge badge-warning">
          {{(detail.status.name)}}
        </div>
        <div *ngIf="detail.status.id == 3" class="badge badge-success">
          {{(detail.status.name)}}
        </div>
        <div *ngIf="detail.status.id == 4" class="badge badge-danger">
          {{(detail.status.name)}} 
          
       </div>
      </span>
    </tr>
    <tr>
      <td>ผู้รับผิดชอบ :</td>
      <span *ngFor="let operators of detail.operators;let i = index ">
        
          {{operators.name}} 
             <span *ngIf="i != detail.operators.length - 1 ">,</span>
      </span>
    </tr>
    <tr>
      <td>เวลาดำเนินการ :</td>
      <span *ngIf="detail.sender_at != 0">
  
        <td>{{detail.sender_at *1000| date: 'dd/MM/yyyy HH:mm'}}</td>
      </span>
    </tr>
    <tr>
      <td>
        รูปแบบปัญหา :
      </td>
      
      <span *ngFor="let problemtype of detail.problemtype;let i = index ">
        {{problemtype.name}}
        <div *ngIf="i != detail.problemtype.length - 1 ">,</div>
      </span>
      
    </tr>
    <tr>
      <td>
        ปัญหาที่พบ :
      </td>
      <td>{{detail.problem}}</td>
    </tr>
    <tr>

      <td>สาเหตุของปัญหา :</td>
      <span *ngIf="detail.status.id == 3">
      
        <td>{{detail.casuseproblem}}</td>
      </span>
    </tr>
    <tr>
      <td>วิธีแก้ปัญหา :</td>
      <span *ngIf="detail.status.id == 3">
        <td>{{detail.solution}}</td>
      </span>
    </tr>
    <tr>
      <td>เวลาเสร็จสิ้น :</td>
      <span *ngIf="detail.status.id == 3">
        <span *ngIf="detail.completed_at != 0">
          <td>{{detail.completed_at *1000| date: 'dd/MM/yyyy HH:mm'}}</td>
        </span>
      </span>
    </tr>
    <tr>
      <td>ระยะเวลาดำเนินงาน :</td>
      <span *ngIf="detail.status.id == 3">
        <td>{{math()}} ชั่วโมง: {{((((detail.time/60)/60)%1)*60).toFixed(0)}} นาที</td>
        
      </span>
    </tr>
    <tr>
      <td>หมายเหตุ :</td>
      <span *ngIf="detail.suggestion !=0 ">
        <td>{{detail.suggestion}}</td>
      </span>
    </tr>
    <br>
    <tr>
      <td>
        ไฟล์ภาพ :
      </td>
    </tr>
  
</table>
      <div style="margin-left: 100px;" >
        <img src="{{URL + part}}" alt=""height="400px"> 
      </div>
<br>
<br>
      <div class="items2">
        
        <button class="cancel-button" (click)="cancel()">ย้อนกลับ</button>
        <button class="forword-button" (click)="forward()" name="btinsert" >ส่งต่อ</button>
        <button class="save-button" (click)="finish()" name="btinsert" >เสร็จสิ้น</button>
        
      </div>
</div>
<br>
<br>

  <div *ngIf="forwardDiv">
    <form [formGroup]="updetproblemDataform" (ngSubmit)="onSubmitUpdate()">
      
      <!-- <mat-form-field >
        <label class="col-12 md:col-4 ptax" for="users"> เลือกผู้รับผิดชอบ</label>
        <mat-select formControlName="operator" [(ngModel)]="updetproblem.operator"  multiple>
          <option *ngFor="let users of users" [value]="users.id">{{users.name}}</option>
        </mat-select>
      </mat-form-field> -->
      <!-- <form>
        <label for="cars">Choose a car:</label>
        <select name="cars" id="cars" multiple>
          <option value="volvo">Volvo</option>
          <option value="saab">Saab</option>
          <option value="opel">Opel</option>
          <option value="audi">Audi</option>
        </select>
      </form> -->
      <!-- <div id="multiselect-sample" class="control-section" style="height: 500px">
          
      </div> -->
      <span class="menu-icon">
      <span
        [inlineSVG]="'./'"
        class="svg-icon svg-icon-2"
      ></span> </span>
      <div >
        <label class="col-12 md:col-4 ptax" for="users"> เลือกผู้รับผิดชอบ</label>
        <select formControlName="operator"  [(ngModel)]="updetproblem.operator" name="operators"  class="form-control" id="users_id" multiple >
          <option *ngFor="let users of users" [value]="users.id">{{users.name}}</option>
        </select>
      </div>
      <br>
      <div class="items2">
        <button class="cancel-button" (click)="cancelforward()">ยกเลิก</button>
        <button class="save-button" type="submit" name="btinsert" >ยืนยัน</button>
        
      </div>
    </form>
  </div>


<br>
<br>
  <div *ngIf="finishDIV">
    <form [formGroup]="finishproblemDataform" (ngSubmit)="onSubmitFinish()">
      <div >
        <label class="col-form-label  ptax" for="problemtype">รูปแบบปัญหา</label>
        <select formControlName="problemtype" [(ngModel)]="finishproblem.problemtype" type="text" name="problemtype"  class="form-control" id="problemtype_id">
        <option *ngFor="let problemtype of problemtype" [value]="problemtype.id">{{problemtype.name}}</option>
      
      </select>
      </div>
      <div >
        <label class="col-form-label  ptax" for="problem">ปัญหาที่พบ</label>
        <textarea formControlName="problem" [(ngModel)]="finishproblem.problem" type="text" name="problem"  class="form-control" id="" cols="50" rows="5"></textarea><!--readonly เป็นการกำหนดค่าไม่ให้มีการเปลี่ยนแปลงได้-->
      </div>
      <br>
      <div>
        <label class="col-12 md:col-4 ptax" for="casuseproblem"> สาเหตุปัญหา</label>
        <textarea formControlName="casuseproblem" [(ngModel)]="finishproblem.casuseproblem" type="text" name="casuseproblem"  class="form-control" id="" cols="50" rows="5"></textarea>
      </div>
      <br>
      <div>
        <label class="col-12 md:col-4 ptax" for="solution"> วิธีแก้ปัญหา</label>
        <textarea formControlName="solution" [(ngModel)]="finishproblem.solution" type="text" name="solution"  class="form-control" id="" cols="50" rows="5"></textarea>
        
      </div>
      <br>
      <div>
        <label class="col-12 md:col-4 ptax" for="suggestion"> หมายเหตุ</label>
        <textarea formControlName="suggestion" [(ngModel)]="finishproblem.suggestion" type="text" name="suggestion"  class="form-control" id="" cols="50" rows="5"></textarea>
      </div>
      <br>
      <div class="items2">
        <button class="cancel-button" (click)="cancelfinsh()">ยกเลิก</button>
        <button class="save-button" type="submit" name="btinsert" >ยืนยัน</button>
        
      </div>
    </form>
  </div>

